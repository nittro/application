_context.invoke("Utils",function(undefined){function getValue(interval){return"number"==typeof interval?interval:interval instanceof DateInterval?interval.getLength():DateInterval.from(interval).getLength()}function formatAuto(interval,precision){precision===!0?precision=intervalNames.length:precision||(precision=2);var i,v,last,str=[],sign="";for(0>interval&&(sign="-",interval=-interval),i=0;i<intervalNames.length&&!(interval>=intervalLengths[i]&&(precision--,v=interval/intervalLengths[i],v=0===precision?Math.round(v):Math.floor(v),str.push(v+" "+intervalHelpers[i].toString(v)),interval-=v*intervalLengths[i],0===precision));i++);return str.length>2?(last=str.pop(),sign+str.join(separators[0])+(separators[1]||separators[0])+last):sign+str.join(separators[1]||separators[0])}function format(interval,pattern){var sign=0>interval?"-":"+";return interval=Math.abs(interval),(pattern+"").replace(/%(.)/g,function(m,f){var v,pad=!1;switch(f){case"%":return"%";case"y":m=intervalLengths[0];break;case"w":m=intervalLengths[1];break;case"m":pad=!0;case"n":m=intervalLengths[2];break;case"d":pad=!0;case"j":m=intervalLengths[3];break;case"H":pad=!0;case"G":m=intervalLengths[4];break;case"i":pad=!0;case"I":m=intervalLengths[5];break;case"s":pad=!0;case"S":m=intervalLengths[6];break;case"-":return"-"===sign?sign:"";case"+":return sign;default:throw new Error("Unknown format modifier: %"+f)}return v=Math.floor(interval/m),interval-=m*v,pad&&10>v?"0"+v:v})}var DateInterval=function(interval){this._={initialized:!1,interval:interval}};DateInterval.from=function(interval){return new DateInterval(interval)};var intervalNames=["year","month","week","day","hour","minute","second","millisecond"],intervalLengths=[31536e6,6048e5,26784e5,864e5,36e5,6e4,1e3,1],intervalHelpers=[{pattern:/^y(?:ears?)?$/,toString:function(n){return 1===n?"year":"years"}},{pattern:/^mon(?:ths?)?$/,toString:function(n){return 1===n?"month":"months"}},{pattern:/^w(?:eeks?)?$/,toString:function(n){return 1===n?"week":"weeks"}},{pattern:/^d(?:ays?)?$/,toString:function(n){return 1===n?"day":"days"}},{pattern:/^h(?:ours?)?$/,toString:function(n){return 1===n?"hour":"hours"}},{pattern:/^min(?:utes?)?$/,toString:function(n){return 1===n?"minute":"minutes"}},{pattern:/^s(?:ec(?:onds?)?)?$/,toString:function(n){return 1===n?"second":"seconds"}},{pattern:/^millis(?:econds?)?$|^ms$/,toString:function(n){return 1===n?"millisecond":"milliseconds"}}],separators=[", "," and "];DateInterval.setHelpers=function(helpers){intervalHelpers=helpers},DateInterval.setSeparators=function(separator,last){separators=[separator,last]},DateInterval.prototype.add=function(interval){return this._initialize(),this._.interval+=getValue(interval),this},DateInterval.prototype.subtract=function(interval){return this._initialize(),this._.interval-=getValue(interval),this},DateInterval.prototype.isNegative=function(){return this._initialize(),this._.interval<0},DateInterval.prototype.getLength=function(){return this._initialize(),this._.interval},DateInterval.prototype.valueOf=function(){return this.getLength()},DateInterval.prototype.format=function(pattern){return this._initialize(),"boolean"!=typeof pattern&&"number"!=typeof pattern&&pattern?format(this._.interval,pattern):formatAuto(this._.interval,pattern)},DateInterval.prototype._initialize=function(){if(!this._.initialized&&(this._.initialized=!0,"number"!=typeof this._.interval)){var interval=this._.interval;if(interval instanceof DateInterval)this._.interval=interval.getLength();else{if("string"!=typeof interval)throw new Error("Invalid interval specification, expected string, number or a DateInterval instance");if(interval.match(/^\s*(?:\+|-)?\s*\d+\s*$/))this._.interval=parseInt(interval.trim());else{var rest,res=0,sign=1;if(rest=interval.replace(/\s*(\+|-)?\s*(\d+)\s+(\S+)\s*/g,function(m,s,n,k){s!==undefined&&(sign="+"===s?1:-1),k=k.toLowerCase(),n=parseInt(n)*sign,m=null;for(var i=0;i<intervalHelpers.length;i++)if(intervalHelpers[i].pattern.test(k)){m=intervalLengths[i];break}if(null===m)throw new Error('Unknown keyword: "'+k+'"');return res+=n*m,""}),rest.length)throw new Error('Invalid interval specification "'+interval+'", didn\'t understand "'+rest+'"');this._.interval=res}}}},_context.register(DateInterval,"DateInterval")}),_context.invoke("Utils",function(Strings,Arrays,DateInterval,undefined){var DateTime=function(d){this._={initialized:!1,date:d||new Date}};DateTime.keywords={weekdays:{abbrev:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{abbrev:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],full:["January","February","March","April","May","June","July","August","September","October","November","December"]},relative:{now:"now",today:"today",tomorrow:"tomorrow",yesterday:"yesterday",noon:"noon",midnight:"midnight",at:"at"}},DateTime.from=function(s){return new DateTime(s)},DateTime.now=function(){return new DateTime},DateTime.isDateObject=function(o){return"object"==typeof o&&o&&o.date!==undefined&&o.timezone!==undefined&&o.timezone_type!==undefined},DateTime.isLeapYear=function(y){return y%4===0&&y%100!==0||y%400===0},DateTime.isModifyString=function(str){var kw=DateTime.keywords.relative,re=new RegExp("(?:^(?:"+[kw.now,kw.yesterday,kw.tomorrow,kw.today].map(Strings.escapeRegex).join("|")+"))|"+Strings.escapeRegex(kw.noon)+"|"+Strings.escapeRegex(kw.midnight)+"|\\d?\\d(?::\\d\\d|\\s*(?:am|pm))(?:\\d\\d)?(?:\\s*(?:am|pm))?|(?:[-+]\\s*)?\\d+\\s+[^\\d\\s]","i");return re.test(str)},DateTime.getDaysInMonth=function(m,y){return 2===m?DateTime.isLeapYear(y)?29:28:m in{4:1,6:1,9:1,11:1}?30:31};var ni=function(){throw new Error("Not implemented!")},pad=function(n){return 10>n?"0"+n:n},formatTz=function(offset){return("string"==typeof offset||offset instanceof String)&&offset.match(/(\+|-)\d\d:\d\d/)?offset:("number"!=typeof offset&&(offset=parseInt(offset)),(0>offset?"+":"-")+pad(parseInt(Math.abs(offset)/60))+":"+pad(Math.abs(offset)%60))};DateTime.getLocalTzOffset=function(){return formatTz((new Date).getTimezoneOffset())},DateTime.formatModifiers={d:function(d,u){return pad(u?d.getUTCDate():d.getDate())},D:function(d,u){return DateTime.keywords.weekdays.abbrev[u?d.getUTCDay():d.getDay()]},j:function(d,u){return u?d.getUTCDate():d.getDate()},l:function(d,u){return DateTime.keywords.weekdays.full[u?d.getUTCDay():d.getDay()]},N:function(d,u,n){return n=u?d.getUTCDay():d.getDay(),0===n?7:n},S:function(d,u,n){return n=u?d.getUTCDate():d.getDate(),n%=10,0===n||n>3?"th":["st","nd","rd"][n-1]},w:function(d,u){return u?d.getUTCDay():d.getDay()},z:function(d,u,n,m,y,M){for(n=u?d.getUTCDate():d.getDate(),n--,y=u?d.getUTCFullYear():d.getFullYear(),m=0,M=u?d.getUTCMonth():d.getMonth();M>m;)n+=DateTime.getDaysInMonth(m++,y);return n},W:ni,F:function(d,u){return DateTime.keywords.months.full[u?d.getUTCMonth():d.getMonth()]},m:function(d,u){return pad((u?d.getUTCMonth():d.getMonth())+1)},M:function(d,u){return DateTime.keywords.months.abbrev[u?d.getUTCMonth():d.getMonth()]},n:function(d,u){return(u?d.getUTCMonth():d.getMonth())+1},t:function(d,u){return DateTime.getDaysInMonth(u?d.getUTCMonth():d.getMonth(),u?d.getUTCFullYear():d.getFullYear())},L:function(d,u){return DateTime.isLeapYear(u?d.getUTCFullYear():d.getFullYear())?1:0},o:ni,Y:function(d,u){return u?d.getUTCFullYear():d.getFullYear()},y:function(d,u){return(u?d.getUTCFullYear():d.getFullYear()).toString().substr(-2)},a:function(d,u,h){return h=u?d.getUTCHours():d.getHours(),h>=0&&12>h?"am":"pm"},A:function(d,u){return DateTime.formatModifiers.a(d,u).toUpperCase()},g:function(d,u,h){return h=u?d.getUTCHours():d.getHours(),0===h?12:h>12?h-12:h},G:function(d,u){return u?d.getUTCHours():d.getHours()},h:function(d,u){return pad(DateTime.formatModifiers.g(d,u))},H:function(d,u){return pad(u?d.getUTCHours():d.getHours())},i:function(d,u){return pad(u?d.getUTCMinutes():d.getMinutes())},s:function(d,u){return pad(u?d.getUTCSeconds():d.getSeconds())},u:function(d,u){return 1e3*(u?d.getUTCMilliseconds():d.getMilliseconds())},e:ni,I:ni,O:function(d,u){return DateTime.formatModifiers.P(d,u).replace(":","")},P:function(d,u){return u?"+00:00":formatTz(d.getTimezoneOffset())},T:ni,Z:function(d,u){return u?0:-60*d.getTimezoneOffset()},c:function(d,u){return DateTime.from(d).format("Y-m-d\\TH:i:sP",u)},r:function(d,u){return DateTime.from(d).format("D, n M Y G:i:s O",u)},U:function(d){return Math.round(d.getTime()/1e3)}},DateTime.prototype.format=function(f,utc){this._initialize();var d=this._.date,pattern=Strings.escapeRegex(Arrays.getKeys(DateTime.formatModifiers).join(",")).replace(/,/g,"|"),re=new RegExp("(\\\\*)("+pattern+")","g");return f.replace(re,function(s,c,m){return c.length%2?c.substr(1)+m:c+""+DateTime.formatModifiers[m](d,utc)})},["getTime","getDate","getDay","getMonth","getFullYear","getHours","getMinutes","getSeconds","getMilliseconds","getTimezoneOffset","getUTCDate","getUTCDay","getUTCMonth","getUTCFullYear","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","toDateString","toISOString","toJSON","toLocaleDateString","toLocaleFormat","toLocaleTimeString","toString","toTimeString","toUTCString"].forEach(function(method){DateTime.prototype[method]=function(){return this._initialize(),this._.date[method].apply(this._.date,arguments)}}),["setTime","setDate","setMonth","setFullYear","setHours","setMinutes","setSeconds","setMilliseconds","setUTCDate","setUTCMonth","setUTCFullYear","setUTCHours","setUTCMinutes","setUTCSeconds","setUTCMilliseconds"].forEach(function(method){DateTime.prototype[method]=function(){return this._initialize(),this._.date[method].apply(this._.date,arguments),this}}),DateTime.prototype.getTimestamp=function(){return this._initialize(),Math.round(this._.date.getTime()/1e3)},DateTime.prototype.getDateObject=function(){return this._initialize(),this._.date},DateTime.prototype.valueOf=function(){return this.getTimestamp()},DateTime.prototype.modify=function(s){this._initialize();var r,re,t=this._.date.getTime(),kw=DateTime.keywords.relative;if(s instanceof DateInterval)return this._.date=new Date(t+s.getLength()),this;if(s=s.toLowerCase(),re=new RegExp("^("+[kw.yesterday,kw.tomorrow,kw.now,kw.today].map(Strings.escapeRegex).join("|")+")\\s*(?:"+Strings.escapeRegex(kw.at)+"\\s*)?"),r=s.match(re))switch(s=s.substr(r[0].length),r[1]){case kw.now:case kw.today:t=Date.now();break;case kw.yesterday:t-=864e5;break;case kw.tomorrow:t+=864e5}return re=new RegExp("^("+Strings.escapeRegex(kw.noon)+"|"+Strings.escapeRegex(kw.midnight)+"|\\d\\d?(?::\\d\\d|\\s*(?:am|pm))(?::\\d\\d)?(?:\\s*(?:am|pm))?)\\s*"),(r=s.match(re))&&(s=s.substr(r[0].length),t=new Date(t),r[1]===kw.noon?t.setHours(12,0,0,0):r[1]===kw.midnight?t.setHours(0,0,0,0):(r=r[1].match(/^(\d\d?)(?::(\d\d))?(?::(\d\d))?(?:\s*(am|pm))?$/),r[1]=parseInt(r[1]),r[2]=r[2]?parseInt(r[2]):0,r[3]=r[3]?parseInt(r[3]):0,r[4]&&("am"===r[4]&&12===r[1]?r[1]=0:"pm"===r[4]&&r[1]<12&&(r[1]+=12)),t.setHours(r[1],r[2],r[3],0)),t=t.getTime()),s.length&&!s.match(/^\s+$/)&&(t+=DateInterval.from(s).getLength()),this._.date=new Date(t),this},DateTime.prototype.modifyClone=function(s){return DateTime.from(this).modify(s)},DateTime.prototype._initialize=function(){if(!this._.initialized)if(this._.initialized=!0,"string"==typeof this._.date){var m;if(m=this._.date.match(/^@(\d+)$/))this._.date=new Date(1e3*m[1]);else if(m=this._.date.match(/^(\d\d\d\d-\d\d-\d\d)[ T](\d\d:\d\d(?::\d\d(?:\.\d+)?)?)([-+]\d\d:?\d\d)?$/))this._.date=new Date(m[1]+"T"+m[2]+(m[3]||""));else if(DateTime.isModifyString(this._.date)){var s=this._.date;this._.date=new Date,this.modify(s)}else this._.date=new Date(this._.date)}else if("number"==typeof this._.date)this._.date=new Date(this._.date);else if(DateTime.isDateObject(this._.date)){var s=this._.date.date;(3!==this._.date.timezone_type||"UTC"===this._.date.timezone)&&(s+=" "+this._.date.timezone),this._.date=new Date(s)}else this._.date instanceof DateTime&&(this._.date=new Date(this._.date.getTime()))},_context.register(DateTime,"DateTime")}),_context.invoke("Nittro.Utils",function(Nittro,Strings,Arrays,HashMap,undefined){var Tokenizer=_context.extend(function(patterns,matchCase){var types=!1;if(!Array.isArray(patterns))if(patterns instanceof HashMap)types=patterns.getKeys(),patterns=patterns.getValues();else{var type,tmp=patterns;types=[],patterns=[];for(type in tmp)tmp.hasOwnProperty(type)&&(types.push(type),patterns.push(tmp[type]))}this._={pattern:"("+patterns.join(")|(")+")",types:types,matchCase:matchCase}},{STATIC:{getCoordinates:function(text,offset){text=text.substr(0,offset);var m=text.match(/\n/g);return[(m?m.length:0)+1,offset-("\n"+text).lastIndexOf("\n")+1]}},tokenize:function(input){var re,tokens,pos,n;return this._.types?(re=new RegExp(this._.pattern,"gm"+(this._.matchCase?"":"i")),tokens=[],pos=0,n=this._.types.length,input.replace(re,function(){var i,ofs=arguments[n+1];for(ofs>pos&&tokens.push([input.substr(pos,ofs-pos),pos,null]),i=1;n>=i;i++)if(arguments[i]!==undefined)return tokens.push([arguments[i],ofs,this._.types[i-1]]),void(pos=ofs+arguments[0].length);throw new Error("Unknown token type: "+arguments[0])}.bind(this)),pos+1<input.length&&tokens.push([input.substr(pos),pos,null])):tokens=Strings.split(input,new RegExp(this._.pattern,"m"+(this._.matchCase?"":"i")),!0,!0,!0),tokens}});_context.register(Tokenizer,"Tokenizer")},{Strings:"Utils.Strings",Arrays:"Utils.Arrays",HashMap:"Utils.HashMap"}),_context.invoke("Nittro.Neon",function(Nittro,HashMap,Tokenizer,Strings,Arrays,DateTime,undefined){var Neon=_context.extend(function(){this._cbStr=this._cbStr.bind(this)},{STATIC:{patterns:["'[^'\\n]*'|\"(?:\\\\.|[^\"\\\\\\n])*\"","(?:[^#\"',:=[\\]{}()\x00- !`-]|[:-][^\"',\\]})\\s])(?:[^,:=\\]})(\x00- ]|:(?![\\s,\\]})]|$)|[ \\t]+[^#,:=\\]})(\x00- ])*","[,:=[\\]{}()-]","?:#.*","\\n[\\t ]*","?:[\\t ]+"],brackets:{"{":"}","[":"]","(":")"},consts:{"true":!0,True:!0,TRUE:!0,yes:!0,Yes:!0,YES:!0,on:!0,On:!0,ON:!0,"false":!1,False:!1,FALSE:!1,no:!1,No:!1,NO:!1,off:!1,Off:!1,OFF:!1,"null":null,Null:null,NULL:null},indent:"    ",BLOCK:1,encode:function(data,options){var tmp,s,isList;return data instanceof DateTime?data.format("Y-m-d H:i:s O"):data instanceof NeonEntity?(tmp=Neon.encode(data.attributes),Neon.encode(data.value)+"("+tmp.substr(1,tmp.length-2)+")"):data&&"object"==typeof data?(s=[],isList=Array.isArray(data),options&Neon.BLOCK?(Arrays.walk(data,function(k,v){v=Neon.encode(v,Neon.BLOCK),s.push(isList?"-":Neon.encode(k)+":",Strings.contains(v,"\n")?"\n"+Neon.indent+v.replace(/\n/g,"\n"+Neon.indent):" "+v,"\n")}),s.length?s.join(""):"[]"):(Arrays.walk(data,function(k,v){s.push(isList?"":Neon.encode(k)+": ",Neon.encode(v),", ")}),s.pop(),(isList?"[":"{")+s.join("")+(isList?"]":"}"))):"string"!=typeof data||Strings.isNumeric(data)||data.match(/[\x00-\x1F]|^\d{4}|^(true|false|yes|no|on|off|null)$/i)||!data.match(new RegExp("^"+Neon.patterns[1]+"$"))?JSON.stringify(data):data},decode:function(input){if("string"!=typeof input)throw new Error("Invalid argument, must be a string");Neon.tokenizer||(Neon.tokenizer=new Tokenizer(Neon.patterns)),input=input.replace(/\r/g,"");var res,parser=new Neon;for(parser.input=input,parser.tokens=Neon.tokenizer.tokenize(input),res=parser.parse(0,new HashMap);parser.tokens[parser.n]!==undefined;)"\n"===parser.tokens[parser.n][0].charAt(0)?parser.n++:parser.error();return res}},input:null,tokens:null,n:0,indentTabs:null,parse:function(indent,result){indent===undefined&&(indent=null),result===undefined&&(result=new HashMap);for(var t,inlineParser=null===indent,value=null,key=null,entity=null,hasValue=!1,hasKey=!1;this.n<this.tokens.length;this.n++)if(t=this.tokens[this.n][0],","===t)(hasKey||hasValue)&&inlineParser||this.error(),this.addValue(result,hasKey,key,hasValue?value:null),hasKey=hasValue=!1;else if(":"===t||"="===t)(hasKey||!hasValue)&&this.error(),"string"!=typeof value&&"number"!=typeof value&&this.error("Unacceptable key"),key=Strings.toString(value),hasKey=!0,hasValue=!1;else if("-"===t)(hasKey||hasValue||inlineParser)&&this.error(),key=null,hasKey=!0;else if(Neon.brackets[t]!==undefined)hasValue?("("!==t&&this.error(),this.n++,entity=new NeonEntity,entity.value=value,entity.attributes=this.parse(null,new HashMap),value=entity):(this.n++,value=this.parse(null,new HashMap)),hasValue=!0,(this.tokens[this.n]===undefined||this.tokens[this.n][0]!==Neon.brackets[t])&&this.error();else{if("}"===t||"]"===t||")"===t){inlineParser||this.error();break}if("\n"===t.charAt(0))if(inlineParser)(hasKey||hasValue)&&(this.addValue(result,hasKey,key,hasValue?value:null),hasKey=hasValue=!1);else{for(;this.tokens[this.n+1]!==undefined&&"\n"===this.tokens[this.n+1][0].charAt(0);)this.n++;if(this.tokens[this.n+1]===undefined)break;var newIndent=this.tokens[this.n][0].length-1;if(null===indent&&(indent=newIndent),newIndent&&(null===this.indentTabs&&(this.indentTabs="	"===this.tokens[this.n][0].charAt(1)),Strings.contains(this.tokens[this.n][0],this.indentTabs?" ":"	")&&(this.n++,this.error("Either tabs or spaces may be used for indentation, not both"))),newIndent>indent)hasValue||!hasKey?(this.n++,this.error("Unexpected indentation")):this.addValue(result,null!==key,key,this.parse(newIndent,new HashMap)),newIndent=this.tokens[this.n]!==undefined?this.tokens[this.n][0].length-1:0,hasKey=!1;else{if(hasValue&&!hasKey)break;hasKey&&(this.addValue(result,null!==key,key,hasValue?value:null),hasKey=hasValue=!1)}if(indent>newIndent)return result}else hasValue&&this.error(),value='"'===t.charAt(0)?t.substr(1,t.length-2).replace(/\\(?:u[0-9a-f]{4}|x[0-9a-f]{2}|.)/gi,this._cbStr):"'"===t.charAt(0)?t.substr(1,t.length-2):Neon.consts[t]!==undefined?Neon.consts[t]:Strings.isNumeric(t)?parseFloat(t):t.match(/^\d\d\d\d-\d\d?-\d\d?(?:(?:[Tt]| +)\d\d?:\d\d(?::\d\d(?:\.\d*)?)? *(?:Z|[-+]\d\d?(?::?\d\d)?)?)?$/)?DateTime.from(t):t,hasValue=!0}return inlineParser?(hasKey||hasValue)&&this.addValue(result,hasKey,key,hasValue?value:null):hasValue&&!hasKey?result.length?this.error():result=value:hasKey&&this.addValue(result,null!==key,key,hasValue?value:null),result},addValue:function(result,hasKey,key,value){hasKey?(result&&result.has(key)&&this.error("Duplicated key "+key),result.set(key,value)):result.push(value)},_cbStr:function(m){var mapping={t:"	",n:"\n",r:"\r",f:"\f",b:"\b",'"':'"',"\\":"\\","/":"/",_:"Â "};return mapping[m.charAt(1)]!==undefined?mapping[m.charAt(1)]:"u"===m.charAt(1)&&6===m.length?String.fromCharCode(parseInt(m.substr(2),16)):"x"===m.charAt(1)&&4===m.length?String.fromCharCode(parseInt(m.substr(2),16)):void this.error("Invalid escape sequence "+m)},error:function(msg){var last=this.tokens[this.n]!==undefined?this.tokens[this.n]:null,pos=Tokenizer.getCoordinates(this.input,last?last[1]:this.input.length),token=last?last[0].substr(0,40).replace(/\n/g,"<new line>"):"end";throw new Error((msg||"Unexpected %s").replace(/%s/g,token)+" on line "+pos[0]+", column "+pos[1])}}),NeonEntity=this.NeonEntity=function(value,attributes){this.value=value||null,this.attributes=attributes||null};_context.register(Neon,"Neon"),_context.register(NeonEntity,"NeonEntity")},{HashMap:"Utils.HashMap",Strings:"Utils.Strings",Arrays:"Utils.Arrays",DateTime:"Utils.DateTime",Tokenizer:"Nittro.Utils.Tokenizer"}),_context.invoke("Nittro.Forms",function(DOM,Arrays){if(!window.Nette||!window.Nette.validators)throw new Error("Nette/Forms vendor netteForms.js asset has not been loaded");var VendorForms=window.Nette;_context.register(VendorForms,"Vendor"),VendorForms.validators.mimeType=function(elem,arg,val){Array.isArray(arg)||(arg=arg.trim().split(/\s*,\s*/));try{if(!val.length)return!1;for(var i=0;i<val.length;i++)if(-1===arg.indexOf(val[i].type)&&-1===arg.indexOf(val[i].type.replace(/\/.*/,"/*")))return!1}catch(e){}return!0}},{DOM:"Utils.DOM",Arrays:"Utils.Arrays"}),_context.invoke("Nittro.Forms",function(DOM,Arrays,DateTime,FormData,Vendor,undefined){var Form=_context.extend("Nittro.Object",function(form){if(Form.Super.call(this),"string"==typeof form&&(form=DOM.getById(form)),!(form&&form instanceof HTMLFormElement))throw new TypeError("Invalid argument, must be a HTMLFormElement");this._.form=form,this._.form.noValidate="novalidate",this._.submittedBy=null,DOM.addListener(this._.form,"submit",this._handleSubmit.bind(this)),DOM.addListener(this._.form,"reset",this._handleReset.bind(this))},{getElement:function(name){return name?this._.form.elements.namedItem(name):this._.form},getElements:function(){return this._.form.elements},setSubmittedBy:function(value){return this._.submittedBy=value,this},validate:function(){if(!Vendor.validateForm(this._.form))return!1;var evt=this.trigger("validate");return!evt.isDefaultPrevented()},setValues:function(values,reset){var i,elem,name,value,names=[];for(values||(values={}),i=0;i<this._.form.elements.length;i++)if(elem=this._.form.elements.item(i),name=elem.name,value=undefined,!(!name||names.indexOf(name)>-1||"button"===elem.tagName.toLowerCase()||elem.type in{submit:1,reset:1,button:1,image:1})){if(names.push(name),name.indexOf("[")>-1?(value=values,name.replace(/]/g,"").split(/\[/g).some(function(key){return""===key?!0:key in value?(value=value[key],!1):(value=undefined,!0)})):name in values&&(value=values[name]),value===undefined){if(!reset)continue;value=null}this.setValue(name,value)}},setValue:function(elem,value){"string"==typeof elem&&(elem=this._.form.elements.namedItem(elem));var i,toStr=function(v){return""+v};if(!elem)throw new TypeError("Invalid argument to setValue(), must be (the name of) an existing form element");if(elem.tagName)if("radio"===elem.type)elem.checked=null!==value&&elem.value===toStr(value);else if("file"===elem.type)null===value&&(value=elem.parentNode.innerHTML,DOM.html(elem.parentNode,value));else if("select"===elem.tagName.toLowerCase()){var v,single="select-one"===elem.type,arr=Array.isArray(value);for(value=arr?value.map(toStr):toStr(value),i=0;i<elem.options.length&&(v=arr?value.indexOf(elem.options.item(i).value)>-1:value===elem.options.item(i).value,elem.options.item(i).selected=v,!v||!single);i++);}else"checkbox"===elem.type?elem.checked=Array.isArray(value)?value.map(toStr).indexOf(elem.value)>-1:!!value:"date"===elem.type?elem.value=value?DateTime.from(value).format("Y-m-d"):"":"datetime-local"===elem.type||"datetime"===elem.type?elem.value=value?DateTime.from(value).format("Y-m-d\\TH:i:s"):"":elem.value=null!==value?toStr(value):"";else if("length"in elem)for(i=0;i<elem.length;i++)this.setValue(elem[i],value);return this},serialize:function(){var elem,i,value,data=new FormData,names=[];for(i=0;i<this._.form.elements.length;i++)elem=this._.form.elements.item(i),!elem.name||-1!==names.indexOf(elem.name)||("submit"!==elem.type||elem.name!==this._.submittedBy)&&elem.type in{submit:1,button:1,reset:1}||names.push(elem.name);for(i=0;i<names.length;i++)if(elem=this._.form.elements.namedItem(names[i]),!Vendor.isDisabled(elem))if(value=Vendor.getEffectiveValue(elem),Array.isArray(value)||value instanceof FileList)for(var j=0;j<value.length;j++)data.append(names[i],value[j]);else data.append(names[i],value);return this.trigger("serialize",data),data},submit:function(by){var evt;if(by){var btn=this._.form.elements.namedItem(by);if(btn&&"submit"===btn.type){try{evt=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})}catch(e){evt=document.createEvent("MouseEvents"),evt.initMouseEvent("click",!0,!0,window)}return btn.dispatchEvent(evt),this}throw new TypeError("Unknown element or not a submit button: "+by)}try{evt=new Event("submit",{bubbles:!0,cancelable:!0})}catch(e){evt=document.createEvent("HTMLEvents"),evt.initEvent("submit",!0,!0)}return this._.form.dispatchEvent(evt),this},reset:function(){return this._.form.reset(),this},_handleSubmit:function(evt){return this.trigger("submit").isDefaultPrevented()?void evt.preventDefault():void(this.validate()||evt.preventDefault())},_handleReset:function(evt){if(evt.target===this._.form){var elem,i;for(i=0;i<this._.form.elements.length;i++)elem=this._.form.elements.item(i),"hidden"===elem.type&&elem.hasAttribute("data-default-value")?this.setValue(elem,DOM.getData(elem,"default-value")||""):"file"===elem.type&&this.setValue(elem,null);this.trigger("reset")}}});_context.register(Form,"Form")},{DOM:"Utils.DOM",Arrays:"Utils.Arrays",DateTime:"Utils.DateTime",FormData:"Nittro.Ajax.FormData"}),_context.invoke("Nittro.Forms",function(Form,Vendor){var Locator=_context.extend(function(flashMessages){this._={flashMessages:flashMessages,registry:{},anonId:0},Vendor.addError=this._handleError.bind(this)},{getForm:function(id){var elem;return"string"!=typeof id&&(elem=id,elem.getAttribute("id")||elem.setAttribute("id","frm-anonymous"+ ++this._.anonId),id=elem.getAttribute("id")),id in this._.registry||(this._.registry[id]=new Form(elem||id),this._.registry[id].on("error:default",this._showError.bind(this))),this._.registry[id]},removeForm:function(id){"string"!=typeof id&&(id=id.getAttribute("id")),id in this._.registry&&delete this._.registry[id]},_handleError:function(elem,msg){var frm=this.getForm(elem.form);frm.trigger("error",{elem:elem,message:msg})},_showError:function(evt){this._.flashMessages.add(evt.data.elem,"warning",evt.data.message),evt.data.elem&&"function"==typeof evt.data.elem.focus&&evt.data.elem.focus()}});_context.register(Locator,"Locator")}),_context.invoke("Nittro.DI",function(Nittro,ReflectionClass,ReflectionFunction,Arrays,Strings,HashMap,Neon,NeonEntity,undefined){var prepare=function(self){self._||(self._={}),self._.services||(self._.services={},self._.serviceDefs={})},Container={addService:function(name,service){if(prepare(this),this._.services[name]||this._.serviceDefs[name])throw new Error('Container already has a service named "'+name+'"');return this._.services[name]=service,this},addServiceDefinition:function(name,definition){if(prepare(this),this._.services[name]||this._.serviceDefs[name])throw new Error('Container already has a service named "'+name+'"');return this._.serviceDefs[name]=definition,this},getService:function(name){if(prepare(this),"container"===name)return this;if(this._.services[name]===undefined){if(!this._.serviceDefs[name])throw new Error('Container has no service named "'+name+'"');this._createService(name)}return this._.services[name]},hasService:function(name){return prepare(this),"container"===name||this._.services[name]!==undefined||this._.serviceDefs[name]!==undefined},isServiceCreated:function(name){if(!this.hasService(name))throw new Error('Container has no service named "'+name+'"');return!!this._.services[name]},runServices:function(){prepare(this);var name,def;for(name in this._.serviceDefs)def=this._.serviceDefs[name],("string"==typeof def&&def.match(/!$/)||def.factory!==undefined&&def.run)&&this.getService(name)},invoke:function(callback,args,thisArg){return prepare(this),args=this._autowireArguments(callback,args),callback.apply(thisArg||null,this._expandArguments(args))},_createService:function(name){if(!this._.serviceDefs[name])throw new Error('Container has no service "'+name+'"');"string"==typeof this._.serviceDefs[name]&&(this._.serviceDefs[name]={run:!!this._.serviceDefs[name].match(/!$/),factory:this._.serviceDefs[name].replace(/!$/,"")});var factory,obj,service,def=this._.serviceDefs[name];if("function"==typeof def.factory){if(service=this.invoke(def.factory),!service)throw new Error('Factory failed to create service "'+name+'"')}else if(factory=this._toEntity(def.factory),service=this._expandEntity(factory),service===factory)throw new Error('Invalid factory for service "'+name+'"');if(this._.services[name]=service,def.setup!==undefined)for(var i=0;i<def.setup.length;i++)"function"==typeof def.setup[i]?this.invoke(def.setup[i],null,service):(obj=this._toEntity(def.setup[i]),this._expandEntity(obj,service));return service},_autowireArguments:function(callback){var i,a,argList=ReflectionFunction.from(callback).getArgs(),args=Arrays.createFrom(arguments,1).filter(function(arg){return!!arg}).map(function(arg){return arg instanceof HashMap?arg.isList()&&(arg=HashMap.from(arg.getValues(),argList)):arg=HashMap.from(arg,argList),arg});lookupArg:for(i=0;i<argList.length;i++){for(a=args.length-1;a>=0;a--){if(args[a].has(argList[i])){argList[i]=args[a].get(argList[i]);continue lookupArg}if(args[a].has(i)){argList[i]=args[a].get(i);continue lookupArg}}{if(!this.hasService(argList[i]))throw new Error('Cannot autowire argument "'+argList[i]+'" of function');argList[i]=this.getService(argList[i])}}return argList},_expandArguments:function(args){for(var i=0;i<args.length;i++)args[i]=this._expandArg(args[i]);return args},_expandArg:function(arg){return arg instanceof NeonEntity?this._expandEntity(arg):"string"==typeof arg&&arg.match(/^@\S+$/)?this.getService(arg.substr(1)):arg},_toEntity:function(str){var m=str.match(/^([^\(]+)\((.*)\)$/);return m?new NeonEntity(m[1],Neon.decode("["+m[2]+"]")):new NeonEntity(str,new HashMap)},_expandEntity:function(entity,context,mergeArgs){var m,obj,method,args;if(m=entity.value.match(/^(?:(@)?([^:].*?))?(?:::(.+))?$/)){if(m[2])obj=m[1]?this.getService(m[2]):ReflectionClass.getClass(m[2]);else{if(!context)throw new Error("No context for calling "+entity.value+" given");obj=context}if(m[3]!==undefined)return method=m[3],args=this._autowireArguments(obj[method],entity.attributes,mergeArgs),obj[method].apply(obj,this._expandArguments(args));if(m[1]){if(entity.attributes.length)throw new Error('Invalid entity "'+entity.value+'"');return obj}return args=this._autowireArguments(obj,entity.attributes,mergeArgs),ReflectionClass.from(obj).newInstanceArgs(this._expandArguments(args))}return entity}};_context.register(Container,"Container")},{ReflectionClass:"Utils.ReflectionClass",ReflectionFunction:"Utils.ReflectionFunction",Arrays:"Utils.Arrays",Strings:"Utils.Strings",HashMap:"Utils.HashMap",Neon:"Nittro.Neon.Neon",NeonEntity:"Nittro.Neon.NeonEntity"}),_context.invoke("Nittro.DI",function(Container,Arrays,HashMap,ReflectionClass,NeonEntity,undefined){function traverse(cursor,path,create){"string"==typeof path&&(path=path.split(/\./g));var i,p,n=path.length;for(i=0;n>i;i++){if(p=path[i],Array.isArray(cursor)&&p.match(/^\d+$/)&&(p=parseInt(p)),cursor[p]===undefined){if(!create)return undefined;cursor[p]={}}cursor=cursor[p]}return cursor}var Context=_context.extend(function(config){config||(config={}),this._={params:Arrays.mergeTree({},config.params||null),serviceDefs:Arrays.mergeTree({},config.services||null),services:{},factories:Arrays.mergeTree({},config.factories||null)}},{hasParam:function(name){return traverse(this._.params,name)!==undefined},getParam:function(name,def){var value=traverse(this._.params,name);return value!==undefined?value:def!==undefined?def:null},setParam:function(name,value){name=name.split(/\./g);var p=name.pop(),cursor=this._.params;return name.length&&(cursor=traverse(cursor,name,!0)),Array.isArray(cursor)&&p.match(/^\d+$/)&&(p=parseInt(p)),cursor[p]=value,this},hasFactory:function(name){return this._.factories[name]!==undefined},addFactory:function(name,factory,params){return"string"==typeof factory?this._.factories[name]=factory:this._.factories[name]={callback:factory,params:params||null},this},create:function(name,args){if(!this.hasFactory(name))throw new Error('No factory named "'+name+'" has been registered');var factory=this._.factories[name];return"string"==typeof factory?this._.factories[name]=factory=this._toEntity(factory):factory.params instanceof HashMap||(factory.params=new HashMap(factory.params)),factory instanceof NeonEntity?this._expandEntity(factory,null,args):(args=this._autowireArguments(factory.callback,factory.params,args),factory.callback.apply(null,this._expandArguments(args)))},_expandArg:function(arg){return"string"==typeof arg&&arg.indexOf("%")>-1?arg.match(/^%[^%]+%$/)?this.getParam(arg.replace(/^%|%$/g,"")):arg.replace(/%([a-z0-9_.-]+)%/gi,function(){return this.getParam(arguments[1])}.bind(this)):this.__expandArg(arg);
}});_context.mixin(Context,Container,{_expandArg:"__expandArg"}),_context.register(Context,"Context")},{Arrays:"Utils.Arrays",HashMap:"Utils.HashMap",ReflectionClass:"Utils.ReflectionClass",NeonEntity:"Nittro.Neon.NeonEntity"}),_context.invoke("Nittro.Application",function(){var Storage=_context.extend(function(namespace,persistent){this._.persistent=persistent,this._.engine=persistent?window.localStorage:window.sessionStorage,this._.items={},this._.namespace=namespace||"",this._.filters={"in":[],out:[]}},{STATIC:{NAMESPACE_SEPARATOR:"/",FILTER_IN:"in",FILTER_OUT:"out"},getItem:function(key,need){var value=this._.engine.getItem(this._formatKey(key));if(null===value){if(need)throw new Error;return null}return this._applyFilters(this._parseValue(value),Storage.FILTER_OUT)},setItem:function(key,value){return value=this._stringifyValue(this._applyFilters(value,Storage.FILTER_IN)),this._.engine.setItem(this._formatKey(key),value),this},hasItem:function(key){return null!==this._.engine.getItem(this._formatKey(key))},removeItem:function(key){return this._.engine.removeItem(this._formatKey(key)),this},clear:function(){for(var ns=this._.namespace+Storage.NAMESPACE_SEPARATOR,nsl=ns.length,rem=[],i=0;i<this._.engine.length;i++){var k=this._.engine.key(i);k.substr(0,nsl)===ns&&rem.push(k)}for(;rem.length;)this._.engine.removeItem(rem.shift());return this},walk:function(callback){for(var ns=this._.namespace+Storage.NAMESPACE_SEPARATOR,nsl=ns.length,i=0;i<this._.engine.length;i++){var k=this._.engine.key(i);if(k.substr(0,nsl)===ns){k=k.substr(nsl);var v=this.getItem(k);callback.call(v,k,v)}}},getNamespace:function(namespace){return new this.constructor((this._.namespace?this._.namespace+Storage.NAMESPACE_SEPARATOR:"")+namespace,this._.persistent)},addFilter:function(callback,type){return this._.filters[type].push(callback),this},_formatKey:function(key){return this._.namespace+Storage.NAMESPACE_SEPARATOR+key},_parseValue:function(value){return JSON.parse(value)},_stringifyValue:function(value){return JSON.stringify(value)},_applyFilters:function(value,type){for(var i=0;i<this._.filters[type].length;i++)value=this._.filters[type][i](value);return value}});_context.register(Storage,"Storage")}),_context.invoke("Nittro.Application.Routing",function(Nittro,Strings,Arrays){var URLRoute=_context.extend(Nittro.Object,function(mask){URLRoute.Super.call(this),this._.mask=this._prepareMask(mask)},{STATIC:{styles:{"int":parseInt,"float":parseFloat,bool:function(v){return!v.match(/^(?:0|false|)$/)}}},match:function(url){var params=this.tryMatch(url);params&&(Arrays.mergeTree(params,url.getParams()),this.trigger("match",params))},tryMatch:function(url){var match=this._.mask.pattern.exec(url.getPath().replace(/^\/|\/$/g,""));if(!match)return null;var i,n,p,v,params={};for(match.shift(),i=0,n=this._.mask.map.length;n>i;i++)p=this._.mask.map[i],v=decodeURIComponent(match[i]),p.style?params[p.name]=URLRoute.styles[p.style].call(null,v):params[p.name]=v;return params},_prepareMask:function(mask){var match,param,reTop=/^([<\[\]\(])|^([^<\[\]\(]+)/,reParam=/^([^ #>]+)(?: +([^ #>]+))?(?: +#([^ >]+))? *>/,reParen=/\((?!\?:)/g,reOptional=/^\?:/,map=[],pattern=["^"];for(mask=mask.replace(/^\/|\/$/g,"");mask.length;){if(match=reTop.exec(mask),!match)throw new Error("Invalid mask, error near "+mask.substr(0,10));if(mask=mask.substr(match[0].length),"<"===match[1]){if(param=reParam.exec(mask),!param)throw new Error("Invalid mask, error near "+mask.substr(0,10));if(mask=mask.substr(param[0].length),param[2]?param[2]=param[2].replace(reParen,"(?:"):param[2]="[^/]+",pattern.push("(",param[2],")"),param[3]&&!(param[3]in URLRoute.styles))throw new Error("Unknown parameter style: "+param[3]);map.push({name:param[1],style:param[3]||null})}else"["===match[1]?pattern.push("(?:"):"]"===match[1]?pattern.push(")?"):"("===match[1]?pattern.push(reOptional.test(mask)?"(":"(?:"):pattern.push(Strings.escapeRegex(match[2]))}return pattern.push("$"),{pattern:new RegExp(pattern.join("")),map:map}}});_context.register(URLRoute,"URLRoute")},{Strings:"Utils.Strings",Arrays:"Utils.Arrays"}),_context.invoke("Nittro.Application.Routing",function(Nittro,DOM){var DOMRoute=_context.extend(Nittro.Object,function(selector){DOMRoute.Super.call(this),this._.selector=selector},{match:function(){var matches=DOM.find(this._.selector);matches.length&&this.trigger("match",matches)}});_context.register(DOMRoute,"DOMRoute")},{DOM:"Utils.DOM"}),_context.invoke("Nittro.Application.Routing",function(Nittro,DOMRoute,URLRoute,Url){var Router=_context.extend(Nittro.Object,function(page,basePath){Router.Super.call(this),this._.page=page,this._.basePath="/"+basePath.replace(/^\/|\/$/g,""),this._.routes={dom:{},url:{}},this._.page.on("setup",this._matchAll.bind(this))},{getDOMRoute:function(selector){return selector in this._.routes.dom||(this._.routes.dom[selector]=new DOMRoute(selector)),this._.routes.dom[selector]},getURLRoute:function(mask){return mask in this._.routes.url||(this._.routes.url[mask]=new URLRoute(mask)),this._.routes.url[mask]},_matchAll:function(){var k,url=Url.fromCurrent();if(url.getPath().substr(0,this._.basePath.length)===this._.basePath){url.setPath(url.getPath().substr(this._.basePath.length));for(k in this._.routes.url)this._.routes.url[k].match(url)}for(k in this._.routes.dom)this._.routes.dom[k].match()}});_context.register(Router,"Router")},{Url:"Utils.Url"});